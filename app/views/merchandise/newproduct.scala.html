@(productForm:Form[(Product, String)])(implicit merchant:Option[Merchant])

@import helper._
@merchbase(Messages("merch.product.title"),merchant){

@productForm.errors.map { error =>
<p class="error">
    @error.message
</p>
}

<script type="text/javascript">
    $("#tree2").dynatree({
    checkbox: true,
    selectMode: 2,
    children: treeData,
    onSelect: function(select, node) {
    // Display list of selected nodes
    var selNodes = node.tree.getSelectedNodes();
    // convert to title/key array
    var selKeys = $.map(selNodes, function(node){
    return "[" + node.data.key + "]: '" + node.data.title + "'";
    });
    $("#echoSelection2").text(selKeys.join(", "));
    },
    onClick: function(node, event) {
    // We should not toggle, if target was "checkbox", because this
    // would result in double-toggle (i.e. no toggle)
    if( node.getEventTargetType(event) == "title" )
    node.toggleSelect();
    },
    onKeydown: function(node, event) {
    if( event.which == 32 ) {
    node.toggleSelect();
    return false;
    }
    },
    // The following options are only required, if we have more than one tree on one page:
    cookieId: "dynatree-Cb2",
    idPrefix: "dynatree-Cb2-"
    });
</script>

@form(action = routes.Products.create, 'enctype -> "multipart/form-data") {
<fieldset>
    @defining(productForm("merchantId")) { uidField =>
    <input type="hidden" name="@uidField.name" id="@uidField.id" value="@merchant.get.id">
    }
    @defining(productForm("id")) { uidField =>
    <input type="hidden" name="@uidField.name" id="@uidField.id" value="">
    }

    @inputText(
    productForm("name"),
    '_label -> Messages("product.name"),
    '_error -> productForm.globalError
    )

    @inputText(
    productForm("description"),
    '_label -> Messages("product.desc"),
    '_error -> productForm.globalError
    )

    @inputText(
    productForm("longDescription"),
    '_label -> Messages("product.longdesc"),
    '_error -> productForm.globalError
    )

    @inputText(
    productForm("startDate"),
    '_label -> Messages("product.startDate"),
    '_error -> productForm.globalError
    )

    @inputText(
    productForm("endDate"),
    '_label -> Messages("product.endDate"),
    '_error -> productForm.globalError
    )

    @inputText(
    productForm("categories"),
    '_label -> Messages("product.category"),
    '_error -> productForm.globalError
    )

    @inputFile(
    productForm("image"),
    '_label -> Messages("product.image"),
    '_error -> productForm.globalError
    )


</fieldset>
<div class="submit-action">
    <input type="submit" class="btn primary" value="@Messages("product.add")">
    <a href="@routes.Application.index" class="btn">Cancel</a>
</div>
}
}